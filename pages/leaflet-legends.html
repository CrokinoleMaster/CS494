<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Web Maps How-To</title><link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.4.2/pure.css"><!--[if lte IE 8]><link rel="stylesheet" href="css/layouts/side-menu-old-ie.css"><![endif]--><!--if gt IE 8--><link rel="stylesheet" href="/css/layouts/side-menu.css"><link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/tomorrow-night.min.css"><link rel="stylesheet" href="/css/main.css"><script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script><!--<![endif]--></head><body><div id="layout"><a id="menuLink" href="#menu" class="menu-link"><span></span></a><div id="menu"><div class="pure-menu pure-menu-open"><a href="#" class="pure-menu-heading">CONTENT</a><ul><li><a href="/index.html">Home</a></li><li><a href="/pages/algorithms.html">algorithms</a></li><li><a href="/pages/current-position.html">current position</a></li><li><a href="/pages/track-distance.html">track distance</a></li><li class="pure-menu-selected"><a href="/pages/leaflet-legends.html">leaflet legends</a></li><li><a href="/pages/getting-started.html">getting started</a></li><li><a href="/pages/libraries.html">libraries</a></li><li><a href="/pages/extra-credit.html">extra-credit</a></li></ul></div></div><div id="main"><div class="content"><h1>Leaflet Dynamic Legends</h1>
<p><em>This guide assumes that you have a very basic understanding of
<a href="http://leafletjs.com/" target="_blank">leaflet</a></em></p>
<p><em>If you have not used leaflet before this guide will not help.</em></p>
<p>Leaflet legends are great, but leaflet doesn&#39;t come with a way to switch legends.
You often find that you have multiple overlays for one map, and each requires a
different legend. This guide will show how to create dynamic legends so that only
the legends for the currently visible overlays are displaying. Toggling the overlays
will automatically update the legends being displayed.</p>
<p>First let&#39;s create a function to add legends.</p>
<pre><code class="language-javascript">// app is the object we are using to namespace
app.addLegend = function( value, name ){
    var legend = L.control({ position: &#39;bottomleft&#39; });

    // we are using a helper function, you can see below
    legend.onAdd = leafletLegendHelpers.getOnAddArrayLegend(value, &#39;legend&#39;);

    // assuming app.map is the already created leaflet map
    legend.addTo(app.map);
    legend.name = name;

    // app.legends is an array to keep track of all the legends for the different
    // overlays that are currently visible
    app.legends.push(legend);
}</code></pre>
<p>Next we define the overlay add callback which gets fired when an overlay is toggled
to visible.</p>
<pre><code class="language-javascript">app.map.on(&#39;overlayadd&#39;, function(eventLayer){

    // assuming our overlays data is stored at app.map.layers.overlays
    var overlays = app.map.layers.overlays;

    // we are going to use the JQuery map function here
    // to map the overlays into array
    overlays = $.map(overlays, function(val, i){
        return [val];
    })

    // with overlays as array, we can filter to find the overlay with the same
    // name as the one being added. overlay will consist of only the one that was
    // added
    var overlay = overlays.filter(function(o){
        return 0.name == eventLayer.name;
    })

    // now we can add the legend using the addLegend function we created
    // assuming each overlay object has a legend property which is the legend
    // object
    if (overlay[0]) app.addLegend(overlay[0].legend, overlay[0].name);
});</code></pre>
<p>Now we just need a callback for when we toggle an overlay to not visible</p>
<pre><code class="language-javascript">app.map.on(&#39;overlayremove&#39;, function(eventLayer){

    // if there are currently visible legends
    if (app.legends[0]) {

        // loop through the currently visible legends
        // if the legend&#39;s name is the same as the overlay being removed
        // remove the legend from the map
        // and remove the legend from the current legends array
        app.legends.forEach(function(l,i){
            if (l.name == eventLayer.name){
                l.removeFrom(map);
                app.legends.splice(i, 1);
            }
        });
    }
});</code></pre>
<p>With a few lines of code, we now have leaflet legends that are dynamic!</p>
</div></div></div><script>hljs.configure({tabReplace: '<span class="indent">\t</span>'})
hljs.initHighlightingOnLoad();</script></body></html>